<div class="registration-status-container">
  <div class="status-card card-dota">
    <div *ngIf="loading" class="loading-section">
      <div class="loading">Loading registration status...</div>
    </div>

    <div *ngIf="error" class="error-section">
      <div class="error-message">{{ error }}</div>
      <button class="btn-dota" (click)="goToHome()">Go to Home</button>
    </div>

    <div *ngIf="!loading && !error && registration" class="registration-details">
      <!-- Header Section -->
      <div class="status-header">
        <h1 class="status-title">Registration Status</h1>
        <div 
          class="status-badge" 
          [style.color]="getStatusColor(registration.registration_status)"
          [style.border-color]="getStatusColor(registration.registration_status)"
        >
          <span class="status-icon">{{ getStatusIcon(registration.registration_status) }}</span>
          <span class="status-text">{{ getStatusLabel(registration.registration_status) }}</span>
        </div>
      </div>

      <!-- Admin Notes (if rejected or has notes) -->
      <div 
        *ngIf="registration.admin_notes" 
        class="admin-notes card-dota"
        [class.rejected]="registration.registration_status === 'rejected'"
      >
        <h3>Admin Notes</h3>
        <p>{{ registration.admin_notes }}</p>
      </div>

      <!-- Profile Image -->
      <div class="profile-section" *ngIf="registration.profile_image_url">
        <img 
          [src]="registration.profile_image_url" 
          alt="Profile" 
          class="profile-image"
        />
      </div>

      <!-- Registration Details Grid -->
      <div class="details-grid">
        <div class="detail-item">
          <label class="detail-label">Full Name</label>
          <div class="detail-value">{{ registration.full_name }}</div>
        </div>

        <div class="detail-item">
          <label class="detail-label">Email</label>
          <div class="detail-value">{{ registration.email }}</div>
        </div>

        <div class="detail-item" *ngIf="registration.phone_number">
          <label class="detail-label">Phone Number</label>
          <div class="detail-value">{{ registration.phone_number }}</div>
        </div>

        <div class="detail-item" *ngIf="registration.in_game_name">
          <label class="detail-label">In-Game Name</label>
          <div class="detail-value">{{ registration.in_game_name }}</div>
        </div>

        <div class="detail-item" *ngIf="registration.dota2_friend_id">
          <label class="detail-label">Dota 2 Friend ID</label>
          <div class="detail-value">{{ registration.dota2_friend_id }}</div>
        </div>

        <div class="detail-item" *ngIf="registration.rank_and_mmr">
          <label class="detail-label">Rank & MMR</label>
          <div class="detail-value">{{ registration.rank_and_mmr }}</div>
        </div>

        <div class="detail-item" *ngIf="registration.steam_profile_link">
          <label class="detail-label">Steam Profile</label>
          <div class="detail-value">
            <a 
              [href]="registration.steam_profile_link" 
              target="_blank" 
              rel="noopener noreferrer"
              class="external-link"
            >
              {{ registration.steam_profile_link }}
            </a>
            <span 
              class="verification-badge" 
              [class.verified]="registration.steam_profile_verified"
              [class.unverified]="!registration.steam_profile_verified"
            >
              {{ registration.steam_profile_verified ? '‚úì Verified' : '‚úó Not Verified' }}
            </span>
          </div>
        </div>

        <div class="detail-item" *ngIf="registration.dotabuff_profile_link">
          <label class="detail-label">Dotabuff Profile</label>
          <div class="detail-value">
            <a 
              [href]="registration.dotabuff_profile_link" 
              target="_blank" 
              rel="noopener noreferrer"
              class="external-link"
            >
              {{ registration.dotabuff_profile_link }}
            </a>
          </div>
        </div>

        <div class="detail-item" *ngIf="registration.discord_id">
          <label class="detail-label">Discord ID</label>
          <div class="detail-value">
            {{ registration.discord_id }}
            <span 
              class="verification-badge" 
              [class.verified]="registration.discord_verified"
              [class.unverified]="!registration.discord_verified"
            >
              {{ registration.discord_verified ? '‚úì Verified' : '‚úó Not Verified' }}
            </span>
          </div>
        </div>

        <div class="detail-item" *ngIf="registration.upi_id">
          <label class="detail-label">UPI ID</label>
          <div class="detail-value">{{ registration.upi_id }}</div>
        </div>

        <div class="detail-item">
          <label class="detail-label">Registration Date</label>
          <div class="detail-value">{{ formatDate(registration.created_at) }}</div>
        </div>

        <div class="detail-item">
          <label class="detail-label">Last Updated</label>
          <div class="detail-value">{{ formatDate(registration.updated_at) }}</div>
        </div>

        <div class="detail-item" *ngIf="registration.proof_of_payment_url">
          <label class="detail-label">Proof of Payment</label>
          <div class="detail-value">
            <a 
              [href]="registration.proof_of_payment_url" 
              target="_blank" 
              rel="noopener noreferrer"
              class="btn-outline btn-sm"
            >
              View Payment Proof
            </a>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button *ngIf="canEditRegistration()" class="btn-dota" (click)="editRegistration()">
          Edit Registration
        </button>
        <button class="btn-outline" (click)="goToHome()">
          Go to Home
        </button>
      </div>

      <!-- Status Messages -->
      <div class="status-messages">
        <div 
          *ngIf="registration.registration_status === 'pending'" 
          class="info-message card-dota"
        >
          <h3>‚è≥ Your registration is under review</h3>
          <p>We're reviewing your registration. You'll be notified once it's approved. Make sure your Steam profile is public and you've joined our Discord server!</p>
        </div>

        <div 
          *ngIf="registration.registration_status === 'approved'" 
          class="success-message card-dota"
        >
          <h3>üéâ Registration Approved!</h3>
          <p>Congratulations! Your registration has been approved. You're all set to participate in SubWars 5!</p>
        </div>

        <div 
          *ngIf="registration.registration_status === 'rejected'" 
          class="error-message card-dota"
        >
          <h3>‚ùå Registration Rejected</h3>
          <p>Unfortunately, your registration could not be approved. Please check the admin notes above for details and edit your registration if needed.</p>
        </div>

        <div 
          *ngIf="registration.registration_status === 'payment_pending'" 
          class="warning-message card-dota"
        >
          <h3>üí∞ Payment Pending</h3>
          <p>We're waiting for your payment to be verified. Please ensure you've uploaded proof of payment. We'll review it and update your status shortly.</p>
        </div>
      </div>
    </div>
  </div>
</div>

