import { Controller, Get } from '@nestjs/common';
import { InjectModel } from '@nestjs/sequelize';
import { User } from './models/user.model';
import { Quiz } from './models/quiz.model';

// Example controller showing how to use Sequelize models
@Controller()
export class AppController {
  constructor(
    @InjectModel(User)
    private userModel: typeof User,
    @InjectModel(Quiz)
    private quizModel: typeof Quiz,
  ) {}

  // Example: Get all users
  @Get('users')
  async getUsers() {
    return this.userModel.findAll({
      attributes: ['id', 'email', 'fullName', 'registrationStatus'],
      order: [['createdAt', 'DESC']],
    });
  }

  // Example: Get a specific user
  @Get('users/:id')
  async getUser(id: string) {
    return this.userModel.findByPk(id, {
      include: [{ association: 'answers' }],
    });
  }

  // Example: Get all quizzes
  @Get('quizzes')
  async getQuizzes() {
    return this.quizModel.findAll({
      include: [
        { association: 'questions' },
        { association: 'answers' },
      ],
      order: [['createdAt', 'DESC']],
    });
  }
}

